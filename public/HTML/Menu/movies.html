<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TvBE-Movies</title>
    <link rel="icon" href="../../ASSETS/logo/favicon-ri.ico">

    <!-- Style -->
    <link rel="stylesheet" href="../../CSS/root.css">
    <link rel="stylesheet" href="../../CSS/nav.css">
    <link rel="stylesheet" href="../../CSS/main.css">
    <link rel="stylesheet" href="../../CSS/movies-series.css">
    <link rel="stylesheet" href="../../CSS/load.css">

    <!--Font Family-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-analytics.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";

    
        const firebaseConfig = {
            apiKey: "AIzaSyBH42VD0gk48KLx74gWNU9u-Kz9z751q8A",
            authDomain: "tvbe-24768.firebaseapp.com",
            projectId: "tvbe-24768",
            storageBucket: "tvbe-24768.appspot.com",
            messagingSenderId: "459135185545",
            appId: "1:459135185545:web:30a8f0aa37f56902824c58",
            measurementId: "G-MK82D5BEGM"
        };
    
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app); 
    
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                const db = getFirestore(app);
                const userRef = doc(db, "users", user.uid); 
                const docSnap = await getDoc(userRef);

                const imgElement = document.getElementById('userImage');
                if (imgElement) {
                    if (docSnap.exists()) {
                        const userData = docSnap.data();
                        imgElement.src = userData.profilePicture || '../../ASSETS/user/profile.png';
                    } else {
                        console.log("No such document in Firestore!");
                        imgElement.src = '../../ASSETS/user/profile.png'; 
                    }
                }
            } else {
                window.location.href = 'https://tvbe-24768.web.app/login.html';
            }
        });

    </script>
    <style>
        #userImage{
            width: 32px;
            height: 32px;
        }
    </style>
</head>
<body>
    <header>
        <a href="../../index.html"><img src="../../ASSETS/logo/image_2023-11-21_145906080-removebg-preview.png" alt="Logo" id="logo" draggable="false"></a>
        <!-- Nav bar Menu -->
        <nav>
            <!-- Menu Section -->
            <h3>Menu</h3>
            <ul>
                <li><a href="../../index.html"><img src="../../ASSETS/nav-icons/home.png" alt="Home" width="18rem">Home</a>
                </li>
                <li><a href="movies.html"><img src="../../ASSETS/nav-icons/movies.png" alt="Movies"
                            width="18rem">Movies</a></li>
                <li><a href="series.html"><img src="../../ASSETS/nav-icons/series.png" alt="Series" width="18rem">Series</a></li>
                <li><a href="latest.html"><img src="../../ASSETS/nav-icons/recent.png" alt="Latest releases" width="18rem">Latest
                        releases</a></li>
                <!--<li><a href="HTML/Menu/list.html"><img src="ASSETS/nav-icons/list.png" alt="My list" width="18rem">My list</a></li>-->
            </ul>
            <!-- Settings Section -->
            <h3>Settings</h3>
            <ul>
                <li><a href="../Settings/sub.html"><img src="../../ASSETS/nav-icons/subscription.png" alt="Subscription"
                            width="18rem">Subscription</a></li>
                <li><a href="../Settings/faq.html"><img src="../../ASSETS/nav-icons/faq.png" alt="FAQ"
                            width="18rem">FAQ</a></li>
                <li><a href="#"><img src="../../ASSETS/nav-icons/terms.png" alt="Terms of Use" width="18rem">Terms of
                        Use</a></li>
                <li><a href="../Settings/privacy.html"><img src="../../ASSETS/nav-icons/privacy.png" alt="Privacy" width="18rem">Privacy</a>
                </li>
                <li><a href="../Settings/contact.html"><img src="../../ASSETS/nav-icons/contact.png" alt="Contact us" width="18rem">Contact us</a></li>
                <li><a href="../Settings/user.html"><img src="../../ASSETS/nav-icons/user.png" alt="Account" width="18rem">Account</a></li>
            </ul>
        </nav>
        <li id="ceos">
            <a href="../ceo.html"><img src="../../ASSETS/nav-icons/CEOS.png" alt="CEOS" width="18rem">CEOS</a>
        </li>

        <input type="checkbox" id="menu-phone-button">
        <div id="phone-menu">
            <nav>
                <!-- Menu Section -->
                <h3>Menu</h3>
                <ul>
                    <li><a href="../../index.html"><img src="../../ASSETS/nav-icons/home.png" alt="Home" width="18rem">Home</a></li>
                    <li><a href="movies.html"><img src="../../ASSETS/nav-icons/movies.png" alt="Movies" width="18rem">Movies</a></li>
                    <li><a href="series.html"><img src="../../ASSETS/nav-icons/series.png" alt="Series" width="18rem">Series</a></li>
                    <li><a href="latest.html"><img src="../../ASSETS/nav-icons/recent.png" alt="Latest releases" width="18rem">Latest releases</a></li>
                    <!--<li><a href="HTML/Menu/list.html"><img src="ASSETS/nav-icons/list.png" alt="My list" width="18rem">My list</a></li>-->
                </ul>
                <!-- Settings Section -->
                <h3>Settings</h3>
                <ul>
                    <li><a href="../Settings/"><img src="../../ASSETS/nav-icons/subscription.png" alt="Subscription" width="18rem">Subscription</a></li>
                    <li><a href="../Settings/faq.html"><img src="../../ASSETS/nav-icons/faq.png" alt="FAQ" width="18rem">FAQ</a></li>
                    <li><a href="../Settings/terms.html"><img src="../../ASSETS/nav-icons/terms.png" alt="Terms of Use" width="18rem">Terms of Use</a></li>
                    <li><a href="../Settings/privacy.html"><img src="../../ASSETS/nav-icons/privacy.png" alt="Privacy" width="18rem">Privacy</a></li>
                    <li><a href="../Settings/contact.html"><img src="../../ASSETS/nav-icons/contact.png" alt="Contact us" width="18rem">Contact us</a></li>
                    <li><a href="../Settings/user.html"><img src="../../ASSETS/nav-icons/user.png" alt="Account" width="18rem">Account</a></li>
                </ul>
            </nav>
            <li id="ceos">
                <a href="../ceo.html" ><img src="../../ASSETS/nav-icons/CEOS.png" alt="CEOS" width="18rem">CEOS</a>
            </li>
        </div>
    </header>
    <main>
        <!-- Movies Section -->
        <section>
            <div id="page-top">
                <h1>M<span class="spanMovie">o</span>vies</h1>
                <div action="" id="search-user">
                    <form id="search-form">
                        <input type="text" id="search" placeholder="Search movie..." class="search"/>
                        <img src="../../ASSETS/nav-icons/magnify-glass.png" alt="Magnify" id="magnify">
                    </form>
                    <a id="userLink" href="../Settings/user.html">
                        <img id="userImage" src=""/>
                    </a>                    
                </div>
            </div>

            <!-- TODO: FINISH FILTERS -->
            <div id="filtros">
                <h2>Filters<h2>
                    <form id="filters-form">
                        <select name="genre">
                            <option value="a">Genre</option>
                            <option value="28">Action</option>
                            <option value="35">Comedy</option>
                            <option value="27">Horror</option>
                        </select>
                    
                        <select name="year">
                            <option value="a">Year</option>
                            <option value="2023">2023</option>
                            <option value="2022">2022</option>
                            <option value="2021">2021</option>
                        </select>
                    
                        <select name="rating">
                            <option value="a">Rating</option>
                            <option value="10">10</option>
                            <option value="9">9</option>
                            <option value="8">8</option>
                            <option value="7">7</option>
                        </select>
                        <input type="submit" id="submit" value="Search">
                    </form>                    
            </div>

            <div id="movies">
                	
            </div>
            <div id="btnsNPMovies">
                <button id="prevButton">Previous</button>
                <span id="currentPage">Page 1</span>
                <button id="nextButton">Next Page</button>
            </div>
        </section>
    </main>

    <!-- Script -->
    <script src="../../JS/movies.js"></script>
    <script src="../../JS/nav.js"></script>
</body>
</html>